<html>
  <head>
    <title>
      Code examples for Chapter 5: 'Fold Changes, Log-ratios, Background Correction, Shrinkage Estimation and Variance Stabilisation'
    </title>

    <link rel='stylesheet' type='text/css' href='../useRbook.css'>
    <script src='../useRbook.js' type='text/javascript'></script>
  </head>
  <body style='font-family: helvetica,arial,sans-serif;'>
<small>
  <a class='down' href='vsn.R' target='_blank'>
    download code
  </a>
</small>

<div align='center'>  <table width='400' class='codeContainer'>

<table class='hiddenCodeContainer' id='chunkCont1'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk1'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(1)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk1'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk1' style='display:none;'>
        <span class='header'>
          ## Chunk 1
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(1)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk1' onclick='highlightChunk(1)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

r1&ensp;=&ensp;rnorm(10000,&ensp;mean=2000,&ensp;sd=50)<br>
g1&ensp;=&ensp;rnorm(10000,&ensp;mean=1000,&ensp;sd=50)<br>
hist(r1/g1,&ensp;breaks=33,&ensp;col="azure")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont2'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk2'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(2)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk2'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk2' style='display:none;'>
        <span class='header'>
          ## Chunk 2
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(2)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk2' onclick='highlightChunk(2)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

r2&ensp;=&ensp;rnorm(10000,&ensp;mean=200,&ensp;sd=50)<br>
g2&ensp;=&ensp;rnorm(10000,&ensp;mean=100,&ensp;sd=50)<br>
ratio&ensp;=&ensp;r2/g2&ensp;<br>
ratio&ensp;=&ensp;ratio[(ratio>0)&(ratio<6)]<br>
hist(ratio,&ensp;breaks=33,&ensp;col="azure",&ensp;<br>
&ensp;&ensp;&ensp;&ensp;&ensp;main="Histogram&ensp;of&ensp;r2/g2",&ensp;xlab="r2/g2",<br>
&ensp;&ensp;&ensp;&ensp;&ensp;sub="restricted&ensp;to&ensp;[0,6]")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont3'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk3'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(3)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk3'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk3' style='display:none;'>
        <span class='header'>
          ## Chunk 3
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(3)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk3' onclick='highlightChunk(3)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

hist(log2(r1/g1),&ensp;breaks=33,&ensp;col="azure")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont4'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk4'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(4)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk4'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk4' style='display:none;'>
        <span class='header'>
          ## Chunk 4
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(4)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk4' onclick='highlightChunk(4)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

hist(log2(r2/g2),&ensp;breaks=33,&ensp;col="azure")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont5'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk5' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(5)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk5'>
        <span class='header'>
          ## Chunk 5
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(5)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk5' onclick='highlightChunk(5)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("vsn")<br>
data("kidney")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont6'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk6' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(6)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk6'>
        <span class='header'>
          ## Chunk 6
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(6)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk6' onclick='highlightChunk(6)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("CCl4")<br>
data("CCl4")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont7'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk7' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(7)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk7'>
        <span class='header'>
          ## Chunk 7
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(7)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk7' onclick='highlightChunk(7)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

##&ensp;?&ensp;CCl4
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont8'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk8' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(8)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk8'>
        <span class='header'>
          ## Chunk 8
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(8)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk8' onclick='highlightChunk(8)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

selArrays&ensp;=&ensp;with(pData(CCl4),&ensp;<br>
&ensp;&ensp;&ensp;&ensp;(Cy3&ensp;==&ensp;"CCl4"&ensp;&&ensp;RIN.Cy3&ensp;>&ensp;9)&ensp;|&ensp;<br>
&ensp;&ensp;&ensp;&ensp;(Cy5&ensp;==&ensp;"CCl4"&ensp;&&ensp;RIN.Cy5&ensp;>&ensp;9))<br>
selFeatures&ensp;=&ensp;!is.na(featureData(CCl4)$ID)&ensp;<br>
CCl4s&ensp;=&ensp;CCl4[selFeatures,&ensp;selArrays]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont9'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk9'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(9)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk9'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk9' style='display:none;'>
        <span class='header'>
          ## Chunk 9
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(9)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk9' onclick='highlightChunk(9)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("geneplotter")<br>
pcol&ensp;=&ensp;c("green3",&ensp;"red1")<br>
plty&ensp;=&ensp;1:2<br>
multidensity(exprs(kidney),&ensp;xlim=c(-200,&ensp;1000),<br>
&ensp;&ensp;&ensp;&ensp;main&ensp;=&ensp;"kidney",&ensp;xlab="Intensity",<br>
&ensp;&ensp;&ensp;&ensp;lty&ensp;=&ensp;plty,&ensp;col&ensp;=&ensp;pcol,&ensp;lwd&ensp;=&ensp;2)<br>
legend("topright",&ensp;c("green",&ensp;"red"),&ensp;<br>
&ensp;&ensp;&ensp;&ensp;lty&ensp;=&ensp;plty,&ensp;col&ensp;=&ensp;pcol,&ensp;lwd&ensp;=&ensp;2)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont10'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk10'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(10)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk10'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk10' style='display:none;'>
        <span class='header'>
          ## Chunk 10
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(10)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk10' onclick='highlightChunk(10)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

multidensity(cbind(assayData(CCl4s)$G[,1],&ensp;<br>
&ensp;&ensp;&ensp;&ensp;assayData(CCl4s)$R[,1]),&ensp;xlim=c(0,&ensp;200),<br>
&ensp;&ensp;&ensp;&ensp;main&ensp;=&ensp;expression(CCl[4]),&ensp;lwd=2,&ensp;xlab="Intensity",<br>
&ensp;&ensp;&ensp;&ensp;col&ensp;&ensp;=&ensp;pcol,&ensp;lty&ensp;&ensp;=&ensp;plty)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont11'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk11'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(11)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk11'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk11' style='display:none;'>
        <span class='header'>
          ## Chunk 11
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(11)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk11' onclick='highlightChunk(11)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

px&ensp;=&ensp;seq(-100,&ensp;500,&ensp;length=50)<br>
f&ensp;&ensp;=&ensp;function(x,&ensp;b)&ensp;log2(x+b)<br>
h&ensp;&ensp;=&ensp;function(x,&ensp;a)&ensp;log2((x+sqrt(x^2+a^2))/2)<br>
matplot(px,&ensp;y=cbind(h(px,&ensp;a=50),&ensp;f(px,&ensp;b=50)),&ensp;<br>
&ensp;&ensp;type="l",&ensp;lty=1:2,&ensp;xlab="x",&ensp;ylab="f,&ensp;h")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont12'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk12'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(12)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk12'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk12' style='display:none;'>
        <span class='header'>
          ## Chunk 12
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(12)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk12' onclick='highlightChunk(12)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

px&ensp;=&ensp;seq(0,&ensp;1e8,&ensp;length=50)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont13'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk13'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(13)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk13'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk13' style='display:none;'>
        <span class='header'>
          ## Chunk 13
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(13)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk13' onclick='highlightChunk(13)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

axl&ensp;=&ensp;c(30,&ensp;300)<br>
plot(assayData(CCl4s)$R[,1],&ensp;<br>
&ensp;&ensp;&ensp;&ensp;&ensp;assayData(CCl4s)$G[,1],<br>
&ensp;&ensp;&ensp;&ensp;&ensp;xlim=axl,&ensp;ylim=axl,&ensp;pch=".",&ensp;col="grey",&ensp;<br>
&ensp;&ensp;&ensp;&ensp;&ensp;asp=1)<br>
abline(a=0,&ensp;b=1,&ensp;col="blue",&ensp;lty=2,&ensp;lwd=3)<br>
abline(a=18,&ensp;b=1.2,&ensp;col="red",&ensp;lty=3,&ensp;lwd=3)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont14'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk14' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(14)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk14'>
        <span class='header'>
          ## Chunk 14
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(14)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk14' onclick='highlightChunk(14)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

CCl4sn&ensp;=&ensp;justvsn(CCl4s,&ensp;backgroundsubtract=TRUE)<br>
class(CCl4sn)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont15'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk15' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(15)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk15'>
        <span class='header'>
          ## Chunk 15
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(15)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk15' onclick='highlightChunk(15)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

asd&ensp;=&ensp;assayData(CCl4sn)<br>
A&ensp;=&ensp;(asd$R+asd$G)/2<br>
M&ensp;=&ensp;(asd$R-asd$G)&ensp;
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont16'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk16' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(16)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk16'>
        <span class='header'>
          ## Chunk 16
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(16)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk16' onclick='highlightChunk(16)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

plot(A[,6],&ensp;M[,6],&ensp;pch='.',&ensp;asp=1,&ensp;xlab="A",&ensp;ylab="M")<br>
abline(h=0,&ensp;col="blue")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont17'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk17' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(17)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk17'>
        <span class='header'>
          ## Chunk 17
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(17)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk17' onclick='highlightChunk(17)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

smoothScatter(A[,6],&ensp;M[,6],&ensp;nrpoints=300,&ensp;asp=1,&ensp;<br>
&ensp;&ensp;&ensp;&ensp;xlab="A",&ensp;ylab="M")<br>
abline(h=0,&ensp;col="blue")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont18'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk18' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(18)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk18'>
        <span class='header'>
          ## Chunk 18
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(18)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk18' onclick='highlightChunk(18)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

multidensity(M,&ensp;xlim=c(-2,2),&ensp;bw=0.1)<br>
abline(v=0,&ensp;col="grey")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont19'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk19' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(19)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk19'>
        <span class='header'>
          ## Chunk 19
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(19)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk19' onclick='highlightChunk(19)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

meanSdPlot(cbind(assayData(CCl4sn)$R,&ensp;assayData(CCl4sn)$G),<br>
&ensp;&ensp;&ensp;&ensp;ylim=c(0,&ensp;1.4))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont20'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk20' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(20)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk20'>
        <span class='header'>
          ## Chunk 20
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(20)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk20' onclick='highlightChunk(20)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

kidspike&ensp;=&ensp;kidney<br>
##&ensp;The&ensp;selection&ensp;of&ensp;spike-in&ensp;features&ensp;'sel'&ensp;is&ensp;slightly&ensp;different&ensp;below<br>
##&ensp;from&ensp;how&ensp;it&ensp;was&ensp;done&ensp;in&ensp;Edition&ensp;1&ensp;of&ensp;the&ensp;book,&ensp;namely,&ensp;the&ensp;dimmest<br>
##&ensp;20%&ensp;of&ensp;the&ensp;features&ensp;are&ensp;not&ensp;selected.&ensp;This&ensp;is&ensp;more&ensp;realistic.<br>
m&ensp;=&ensp;rowMeans(exprs(kidspike))<br>
sel&ensp;=&ensp;(runif(length(m))&ensp;<&ensp;1/3)&ensp;&&ensp;(m&ensp;>&ensp;quantile(m,&ensp;0.2))<br>
delta&ensp;=&ensp;100&ensp;+&ensp;0.4*abs(m[sel])<br>
exprs(kidspike)[sel,]&ensp;=&ensp;exprs(kidspike)[sel,]&ensp;+&ensp;<br>
&ensp;&ensp;&ensp;&ensp;cbind(-delta,+delta)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont21'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk21' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(21)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk21'>
        <span class='header'>
          ## Chunk 21
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(21)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk21' onclick='highlightChunk(21)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

ltsq&ensp;=&ensp;c(1,&ensp;0.8,&ensp;0.5)<br>
vkid&ensp;=&ensp;lapply(ltsq,&ensp;function(p)&ensp;vsn2(kidspike,&ensp;<br>
&ensp;&ensp;&ensp;&ensp;lts.quantile=p))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont22'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk22' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(22)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk22'>
        <span class='header'>
          ## Chunk 22
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(22)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk22' onclick='highlightChunk(22)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

getMA&ensp;=&ensp;function(x)&ensp;<br>
&ensp;&ensp;&ensp;&ensp;data.frame(A&ensp;=&ensp;rowSums(exprs(x))/2,<br>
&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;M&ensp;=&ensp;as.vector(diff(t(exprs(x)))))<br>
ma&ensp;=&ensp;lapply(vkid,&ensp;getMA)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont23'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk23' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(23)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk23'>
        <span class='header'>
          ## Chunk 23
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(23)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk23' onclick='highlightChunk(23)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

for(i&ensp;in&ensp;seq(along=ma))&ensp;{<br>
&ensp;&ensp;&ensp;&ensp;ma[[i]]$group&ensp;=&ensp;factor(ifelse(sel,&ensp;"up",&ensp;"unchanged"))<br>
&ensp;&ensp;&ensp;&ensp;ma[[i]]$lts.quantile&ensp;=&ensp;factor(ltsq[i])<br>
}<br>
ma&ensp;=&ensp;do.call("rbind",&ensp;ma)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont24'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk24' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(24)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk24'>
        <span class='header'>
          ## Chunk 24
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(24)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk24' onclick='highlightChunk(24)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("lattice")<br>
lp&ensp;=&ensp;xyplot(M&ensp;~&ensp;A&ensp;|&ensp;lts.quantile,&ensp;group=group,&ensp;data=ma,&ensp;<br>
&ensp;&ensp;&ensp;&ensp;layout&ensp;=&ensp;c(1,3),&ensp;pch=".",&ensp;ylim=c(-3,3),&ensp;xlim=c(6,16),<br>
&ensp;&ensp;&ensp;&ensp;auto.key=TRUE,<br>
&ensp;&ensp;&ensp;&ensp;panel&ensp;=&ensp;function(...){&ensp;<br>
&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;panel.xyplot(...)&ensp;<br>
&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;panel.abline(h=0)},<br>
&ensp;&ensp;&ensp;&ensp;strip&ensp;=&ensp;function(...)&ensp;strip.default(...,&ensp;<br>
&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;strip.names=TRUE,&ensp;strip.levels=TRUE))<br>
print(lp)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont25'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk25' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(25)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk25'>
        <span class='header'>
          ## Chunk 25
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(25)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk25' onclick='highlightChunk(25)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

normctrl&ensp;=&ensp;sample(which(!sel),&ensp;100)<br>
fit&ensp;=&ensp;vsn2(kidspike[normctrl,&ensp;],&ensp;lts.quantile=1)<br>
vkidctrl&ensp;=&ensp;predict(fit,&ensp;newdata=kidspike)<br>
ma&ensp;=&ensp;getMA(vkidctrl)<br>
ma$group&ensp;=&ensp;factor("other",&ensp;levels=c("other",&ensp;<br>
&ensp;&ensp;&ensp;&ensp;"normalization&ensp;control"))<br>
ma$group[normctrl]&ensp;=&ensp;"normalization&ensp;control"
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont26'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk26' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(26)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk26'>
        <span class='header'>
          ## Chunk 26
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(26)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk26' onclick='highlightChunk(26)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

lp&ensp;=&ensp;xyplot(M&ensp;~&ensp;A&ensp;,&ensp;group=group,&ensp;data=ma,&ensp;&ensp;<br>
&ensp;&ensp;&ensp;&ensp;pch=".",&ensp;ylim=c(-3,3),&ensp;xlim=c(4,16),&ensp;auto.key=TRUE,<br>
&ensp;&ensp;&ensp;&ensp;panel&ensp;=&ensp;function(...){&ensp;<br>
&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;panel.xyplot(...)<br>
&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;panel.abline(h=0)})<br>
print(lp)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont27'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk27' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(27)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk27'>
        <span class='header'>
          ## Chunk 27
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(27)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk27' onclick='highlightChunk(27)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

esG&ensp;&ensp;=&ensp;channel(CCl4s,&ensp;"G")<br>
exprs(esG)&ensp;=&ensp;exprs(esG)&ensp;-&ensp;exprs(channel(CCl4s,&ensp;"Gb"))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont28'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk28' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(28)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk28'>
        <span class='header'>
          ## Chunk 28
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(28)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk28' onclick='highlightChunk(28)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

nesG&ensp;=&ensp;justvsn(esG)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont29'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk29' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(29)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk29'>
        <span class='header'>
          ## Chunk 29
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(29)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk29' onclick='highlightChunk(29)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("RColorBrewer")<br>
startedlog&ensp;=&ensp;function(x)&ensp;log2(x+5)<br>
colors&ensp;=&ensp;brewer.pal(6,&ensp;"Dark2")<br>
multiecdf(startedlog(exprs(esG)),&ensp;col=colors,&ensp;<br>
&ensp;&ensp;&ensp;&ensp;main="Before&ensp;normalization")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont30'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk30' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(30)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk30'>
        <span class='header'>
          ## Chunk 30
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(30)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk30' onclick='highlightChunk(30)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

multiecdf(exprs(nesG),&ensp;col=colors,&ensp;<br>
&ensp;&ensp;&ensp;&ensp;main="After&ensp;normalization")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont31'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk31' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(31)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk31'>
        <span class='header'>
          ## Chunk 31
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(31)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk31' onclick='highlightChunk(31)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

smoothScatter(getMA(nesG[,&ensp;1:2]))<br>
abline(h=0,&ensp;col="red")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont32'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk32' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(32)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk32'>
        <span class='header'>
          ## Chunk 32
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(32)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk32' onclick='highlightChunk(32)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

g&ensp;=&ensp;exprs(kidney)[,1]<br>
r&ensp;=&ensp;exprs(kidney)[,2]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont33'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk33' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(33)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk33'>
        <span class='header'>
          ## Chunk 33
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(33)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk33' onclick='highlightChunk(33)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

Aspike&ensp;=&ensp;2^seq(2,&ensp;16,&ensp;by=0.5)<br>
sel&ensp;=&ensp;sample(nrow(kidney),&ensp;length(Aspike))<br>
r[sel]&ensp;=&ensp;Aspike*sqrt(2)<br>
g[sel]&ensp;=&ensp;Aspike/sqrt(2)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont34'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk34' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(34)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk34'>
        <span class='header'>
          ## Chunk 34
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(34)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk34' onclick='highlightChunk(34)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

A&ensp;=&ensp;(log2(r)&ensp;+&ensp;log2(g))/2<br>
M.naive&ensp;=&ensp;&ensp;log2(r)&ensp;-&ensp;log2(g)<br>
fit&ensp;=&ensp;vsn2(cbind(g,&ensp;r))<br>
M.vsn&ensp;=&ensp;exprs(fit)[,2]&ensp;-&ensp;exprs(fit)[,1]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont35'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk35' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(35)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk35'>
        <span class='header'>
          ## Chunk 35
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(35)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk35' onclick='highlightChunk(35)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

plot(A,&ensp;M.naive,&ensp;pch=".",&ensp;ylab="M",&ensp;<br>
&ensp;&ensp;xlim=c(2,16),&ensp;ylim=c(-3,3),&ensp;col="grey")<br>
points(A,&ensp;M.vsn,&ensp;pch=".",&ensp;col="mistyrose")<br>
sel&ensp;=&ensp;sel[order(A[sel])]<br>
lines(A[sel],&ensp;M.vsn[sel],&ensp;col="red",&ensp;lwd=2)<br>
lines(A[sel],&ensp;M.naive[sel],&ensp;lwd=2,&ensp;lty=2)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont36'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk36' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(36)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk36'>
        <span class='header'>
          ## Chunk 36
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(36)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk36' onclick='highlightChunk(36)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

ref&ensp;=&ensp;vsn2(CCl4s[,&ensp;1:5],&ensp;backgroundsubtract=TRUE)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont37'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk37' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(37)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk37'>
        <span class='header'>
          ## Chunk 37
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(37)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk37' onclick='highlightChunk(37)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

x6&ensp;=&ensp;justvsn(CCl4s[,&ensp;6],&ensp;reference&ensp;=&ensp;ref,&ensp;<br>
&ensp;&ensp;&ensp;&ensp;backgroundsubtract=TRUE)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont38'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk38' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(38)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk38'>
        <span class='header'>
          ## Chunk 38
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(38)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk38' onclick='highlightChunk(38)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

plot(assayData(x6)$G,&ensp;assayData(CCl4sn)$G[,6],&ensp;pch=".",&ensp;<br>
&ensp;&ensp;&ensp;&ensp;asp=1)<br>
abline(a=0,&ensp;b=1,&ensp;col="red")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
  </table>
</div>
</body></html>
