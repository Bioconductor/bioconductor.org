<html>
  <head>
    <title>
      Code examples for Chapter 8: 'Annotation and Metadata'
    </title>

    <link rel='stylesheet' type='text/css' href='../useRbook.css'>
    <script src='../useRbook.js' type='text/javascript'></script>
  </head>
  <body style='font-family: helvetica,arial,sans-serif;'>
<small>
  <a class='down' href='annotate.R' target='_blank'>
    download code
  </a>
</small>

<div align='center'>  <table width='400' class='codeContainer'>

<table class='codeContainer' id='chunkCont1'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk1' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(1)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk1'>
        <span class='header'>
          ## Chunk 1
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(1)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk1' onclick='highlightChunk(1)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("BiocCaseStudies")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont2'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk2' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(2)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk2'>
        <span class='header'>
          ## Chunk 2
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(2)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk2' onclick='highlightChunk(2)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("ALL")<br>
data("ALL")<br>
types&ensp;=&ensp;c("ALL1/AF4",&ensp;"BCR/ABL")<br>
bcell&ensp;=&ensp;grep("^B",&ensp;as.character(ALL$BT))<br>
ALL_af4bcr&ensp;=&ensp;ALL[,&ensp;intersect(bcell,&ensp;<br>
&ensp;&ensp;&ensp;&ensp;which(ALL$mol.biol&ensp;%in%&ensp;types))]<br>
ALL_af4bcr$mol.biol&ensp;=&ensp;factor(ALL_af4bcr$mol.biol)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont3'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk3' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(3)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk3'>
        <span class='header'>
          ## Chunk 3
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(3)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk3' onclick='highlightChunk(3)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

table(ALL_af4bcr$mol.biol)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont4'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk4' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(4)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk4'>
        <span class='header'>
          ## Chunk 4
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(4)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk4' onclick='highlightChunk(4)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

qrange&ensp;<-&ensp;function(x)<br>
&ensp;&ensp;&ensp;&ensp;diff(quantile(x,&ensp;c(0.1,&ensp;0.9)))<br>
library("genefilter")<br>
filt_af4bcr&ensp;=&ensp;nsFilter(ALL_af4bcr,&ensp;require.entrez=TRUE,&ensp;<br>
&ensp;&ensp;&ensp;&ensp;require.GOBP=TRUE,&ensp;var.func=qrange,&ensp;var.cutoff=0.5)<br>
ALLfilt_af4bcr&ensp;=&ensp;filt_af4bcr$eset
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont5'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk5' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(5)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk5'>
        <span class='header'>
          ## Chunk 5
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(5)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk5' onclick='highlightChunk(5)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("Biobase")<br>
library("annotate")<br>
library("hgu95av2.db")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont6'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk6' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(6)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk6'>
        <span class='header'>
          ## Chunk 6
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(6)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk6' onclick='highlightChunk(6)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

rt&ensp;=&ensp;rowttests(ALLfilt_af4bcr,&ensp;"mol.biol")<br>
names(rt)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont7'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk7'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(7)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk7'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk7' style='display:none;'>
        <span class='header'>
          ## Chunk 7
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(7)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk7' onclick='highlightChunk(7)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

hist(rt$statistic,&ensp;breaks=100,&ensp;col="skyblue",&ensp;<br>
&ensp;&ensp;&ensp;&ensp;&ensp;main="",&ensp;xlab="t-statistic")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont8'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk8'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(8)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk8'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk8' style='display:none;'>
        <span class='header'>
          ## Chunk 8
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(8)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk8' onclick='highlightChunk(8)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

hist(rt$p.value,&ensp;breaks=100,&ensp;col="mistyrose",<br>
&ensp;&ensp;&ensp;&ensp;&ensp;main="",&ensp;xlab="p-value")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont9'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk9'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(9)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk9'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk9' style='display:none;'>
        <span class='header'>
          ## Chunk 9
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(9)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk9' onclick='highlightChunk(9)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

sel&ensp;=&ensp;order(rt$p.value)[1:400]<br>
ALLsub&ensp;=&ensp;ALLfilt_af4bcr[sel,]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont10'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk10'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(10)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk10'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk10' style='display:none;'>
        <span class='header'>
          ## Chunk 10
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(10)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk10' onclick='highlightChunk(10)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

EG&ensp;&ensp;&ensp;&ensp;=&ensp;as.character(hgu95av2ENTREZID[featureNames(ALL)])<br>
EGsub&ensp;=&ensp;as.character(hgu95av2ENTREZID[featureNames(ALLsub)])
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont11'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk11'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(11)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk11'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk11' style='display:none;'>
        <span class='header'>
          ## Chunk 11
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(11)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk11' onclick='highlightChunk(11)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

table(table(EG))<br>
table(table(EGsub))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont12'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk12'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(12)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk12'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk12' style='display:none;'>
        <span class='header'>
          ## Chunk 12
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(12)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk12' onclick='highlightChunk(12)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

syms&ensp;=&ensp;as.character(hgu95av2SYMBOL[featureNames(ALLsub)])<br>
whFeat&ensp;=&ensp;names(which(syms&ensp;=="CD44"))<br>
ordSamp&ensp;=&ensp;order(ALLsub$mol.biol)<br>
CD44&ensp;=&ensp;ALLsub[whFeat,&ensp;ordSamp]<br>
plot(as.vector(exprs(CD44)),&ensp;main=whFeat,<br>
&ensp;&ensp;&ensp;&ensp;col=c("sienna",&ensp;"tomato")[CD44$mol.biol],&ensp;<br>
&ensp;&ensp;&ensp;&ensp;pch=c(15,&ensp;16)[CD44$mol.biol],&ensp;ylab="expression")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont13'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk13'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(13)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk13'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk13' style='display:none;'>
        <span class='header'>
          ## Chunk 13
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(13)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk13' onclick='highlightChunk(13)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

z&ensp;=&ensp;toTable(hgu95av2CHR[featureNames(ALLsub)])<br>
chrtab&ensp;=&ensp;table(z$chromosome)<br>
chrtab
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont14'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk14'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(14)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk14'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk14' style='display:none;'>
        <span class='header'>
          ## Chunk 14
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(14)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk14' onclick='highlightChunk(14)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

chridx&ensp;=&ensp;sub("X",&ensp;"23",&ensp;names(chrtab))<br>
chridx&ensp;=&ensp;sub("Y",&ensp;"24",&ensp;chridx)<br>
barplot(chrtab[order(as.integer(chridx))])
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont15'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk15' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(15)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk15'>
        <span class='header'>
          ## Chunk 15
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(15)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk15' onclick='highlightChunk(15)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("annaffy")<br>
anncols&ensp;=&ensp;aaf.handler(chip="hgu95av2.db")[c(1:3,&ensp;8:9,&ensp;11:13)]<br>
anntable&ensp;=&ensp;aafTableAnn(featureNames(ALLsub),&ensp;<br>
&ensp;&ensp;&ensp;&ensp;"hgu95av2.db",&ensp;anncols)<br>
saveHTML(anntable,&ensp;"ALLsub.html",&ensp;<br>
&ensp;&ensp;&ensp;&ensp;title="The&ensp;Features&ensp;in&ensp;ALLsub")<br>
localURL&ensp;=&ensp;file.path("file:/",&ensp;getwd(),&ensp;"ALLsub.html")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont16'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk16' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(16)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk16'>
        <span class='header'>
          ## Chunk 16
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(16)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk16' onclick='highlightChunk(16)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

browseURL(localURL)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont17'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk17'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(17)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk17'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk17' style='display:none;'>
        <span class='header'>
          ## Chunk 17
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(17)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk17' onclick='highlightChunk(17)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

probeSetsPerGene&ensp;=&ensp;split(names(EG),&ensp;EG)<br>
j&ensp;=&ensp;probeSetsPerGene$"7013"<br>
j
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont18'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk18'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(18)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk18'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk18' style='display:none;'>
        <span class='header'>
          ## Chunk 18
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(18)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk18' onclick='highlightChunk(18)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

plot(t(exprs(ALL_af4bcr)[j[c(1,7)],&ensp;]),&ensp;asp=1,&ensp;pch=16,<br>
&ensp;&ensp;&ensp;&ensp;col=ifelse(ALL_af4bcr$mol.biol=="ALL1/AF4",&ensp;"black",&ensp;<br>
&ensp;&ensp;&ensp;&ensp;"grey"))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont19'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk19'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(19)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk19'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk19' style='display:none;'>
        <span class='header'>
          ## Chunk 19
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(19)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk19' onclick='highlightChunk(19)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("lattice")<br>
mat&ensp;=&ensp;exprs(ALL_af4bcr)[j,]<br>
mat&ensp;=&ensp;mat&ensp;-&ensp;rowMedians(mat)<br>
ro&ensp;=&ensp;order.dendrogram(as.dendrogram(hclust(dist(mat))))<br>
co&ensp;=&ensp;order.dendrogram(as.dendrogram(hclust(dist(t(mat)))))<br>
at&ensp;=&ensp;seq(-1,&ensp;1,&ensp;length=21)&ensp;*&ensp;max(abs(mat))<br>
lp&ensp;=&ensp;levelplot(t(mat[ro,&ensp;co]),<br>
&ensp;&ensp;aspect&ensp;=&ensp;"fill",&ensp;at&ensp;=&ensp;at,<br>
&ensp;&ensp;scales&ensp;=&ensp;list(x&ensp;=&ensp;list(rot&ensp;=&ensp;90)),<br>
&ensp;&ensp;colorkey&ensp;=&ensp;list(space&ensp;=&ensp;"left"))<br>
print(lp)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont20'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk20'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(20)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk20'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk20' style='display:none;'>
        <span class='header'>
          ## Chunk 20
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(20)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk20' onclick='highlightChunk(20)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

ps_chr&ensp;=&ensp;toTable(hgu95av2CHR)<br>
ps_eg&ensp;&ensp;=&ensp;toTable(hgu95av2ENTREZID)<br>
chr&ensp;=&ensp;merge(ps_chr,&ensp;ps_eg)<br>
chr&ensp;=&ensp;unique(chr[,&ensp;colnames(chr)!="probe_id"])<br>
head(chr)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont21'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk21'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(21)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk21'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk21' style='display:none;'>
        <span class='header'>
          ## Chunk 21
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(21)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk21' onclick='highlightChunk(21)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

table(table(chr$gene_id))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont22'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk22'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(22)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk22'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk22' style='display:none;'>
        <span class='header'>
          ## Chunk 22
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(22)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk22' onclick='highlightChunk(22)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

chr&ensp;=&ensp;chr[!duplicated(chr$gene_id),&ensp;]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont23'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk23'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(23)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk23'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk23' style='display:none;'>
        <span class='header'>
          ## Chunk 23
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(23)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk23' onclick='highlightChunk(23)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

isdiff&ensp;=&ensp;chr$gene_id&ensp;%in%&ensp;EGsub&ensp;<br>
tab&ensp;=&ensp;table(isdiff,&ensp;chr$chromosome)<br>
tab<br>
fisher.test(tab,&ensp;simulate.p.value=TRUE)&ensp;<br>
chisq.test(tab)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont24'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk24'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(24)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk24'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk24' style='display:none;'>
        <span class='header'>
          ## Chunk 24
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(24)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk24' onclick='highlightChunk(24)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

chrloc&ensp;=&ensp;toTable(hgu95av2CHRLOC[featureNames(ALLsub)])<br>
head(chrloc)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont25'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk25'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(25)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk25'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk25' style='display:none;'>
        <span class='header'>
          ## Chunk 25
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(25)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk25' onclick='highlightChunk(25)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

table(table(chrloc$probe_id))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont26'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk26'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(26)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk26'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk26' style='display:none;'>
        <span class='header'>
          ## Chunk 26
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(26)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk26' onclick='highlightChunk(26)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

strds&ensp;=&ensp;with(chrloc,&ensp;<br>
&ensp;&ensp;unique(cbind(probe_id,&ensp;sign(start_location))))<br>
table(strds[,2])
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont27'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk27' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(27)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk27'>
        <span class='header'>
          ## Chunk 27
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(27)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk27' onclick='highlightChunk(27)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("GO.db")<br>
as.list(GOMFCHILDREN["GO:0008094"])
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont28'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk28' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(28)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk28'>
        <span class='header'>
          ## Chunk 28
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(28)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk28' onclick='highlightChunk(28)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

as.list(GOMFOFFSPRING["GO:0008094"])
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont29'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk29' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(29)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk29'>
        <span class='header'>
          ## Chunk 29
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(29)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk29' onclick='highlightChunk(29)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("GOstats")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont30'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk30' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(30)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk30'>
        <span class='header'>
          ## Chunk 30
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(30)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk30' onclick='highlightChunk(30)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

affyUniverse&ensp;=&ensp;featureNames(ALLfilt_af4bcr)<br>
uniId&ensp;=&ensp;hgu95av2ENTREZID[affyUniverse]<br>
entrezUniverse&ensp;=&ensp;unique(as.character(uniId))<br>
params&ensp;=&ensp;new("GOHyperGParams",<br>
&ensp;&ensp;&ensp;&ensp;geneIds=EGsub,&ensp;universeGeneIds=entrezUniverse,<br>
&ensp;&ensp;&ensp;&ensp;annotation="hgu95av2",&ensp;ontology="BP",<br>
&ensp;&ensp;&ensp;&ensp;pvalueCutoff=0.001,&ensp;conditional=FALSE,<br>
&ensp;&ensp;&ensp;&ensp;testDirection="over")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont31'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk31' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(31)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk31'>
        <span class='header'>
          ## Chunk 31
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(31)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk31' onclick='highlightChunk(31)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

mfhyper&ensp;=&ensp;hyperGTest(params)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont32'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk32' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(32)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk32'>
        <span class='header'>
          ## Chunk 32
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(32)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk32' onclick='highlightChunk(32)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

hist(pvalues(mfhyper),&ensp;breaks=50,&ensp;col="mistyrose")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont33'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk33'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(33)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk33'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk33' style='display:none;'>
        <span class='header'>
          ## Chunk 33
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(33)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk33' onclick='highlightChunk(33)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

sum&ensp;=&ensp;summary(mfhyper,&ensp;p=0.001)<br>
head(sum)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont34'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk34'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(34)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk34'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk34' style='display:none;'>
        <span class='header'>
          ## Chunk 34
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(34)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk34' onclick='highlightChunk(34)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

GOTERM[["GO:0032945"]]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont35'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk35' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(35)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk35'>
        <span class='header'>
          ## Chunk 35
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(35)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk35' onclick='highlightChunk(35)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

##&ensp;library("biomaRt")<br>
##&ensp;head(listMarts())
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont36'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk36' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(36)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk36'>
        <span class='header'>
          ## Chunk 36
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(36)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk36' onclick='highlightChunk(36)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

##&ensp;mart&ensp;=&ensp;useMart("ensembl")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont37'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk37' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(37)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk37'>
        <span class='header'>
          ## Chunk 37
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(37)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk37' onclick='highlightChunk(37)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

##&ensp;head(listDatasets(mart))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont38'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk38' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(38)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk38'>
        <span class='header'>
          ## Chunk 38
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(38)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk38' onclick='highlightChunk(38)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

##&ensp;ensembl&ensp;=&ensp;useDataset("hsapiens_gene_ensembl",&ensp;<br>
##&ensp;&ensp;&ensp;&ensp;&ensp;mart=mart)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont39'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk39'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(39)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk39'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk39' style='display:none;'>
        <span class='header'>
          ## Chunk 39
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(39)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk39' onclick='highlightChunk(39)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

##&ensp;utr&ensp;=&ensp;getSequence(id=EGsub,&ensp;seqType="3utr",&ensp;<br>
##&ensp;&ensp;&ensp;&ensp;&ensp;mart=ensembl,&ensp;type="entrezgene")<br>
##&ensp;utr[1,]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont40'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk40' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(40)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk40'>
        <span class='header'>
          ## Chunk 40
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(40)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk40' onclick='highlightChunk(40)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

##&ensp;head(listFilters(ensembl))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont41'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk41' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(41)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk41'>
        <span class='header'>
          ## Chunk 41
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(41)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk41' onclick='highlightChunk(41)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

##&ensp;head(listAttributes(ensembl))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont42'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk42'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(42)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk42'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk42' style='display:none;'>
        <span class='header'>
          ## Chunk 42
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(42)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk42' onclick='highlightChunk(42)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

##&ensp;domains&ensp;=&ensp;getBM(attributes=c("entrezgene",&ensp;"pfam",&ensp;<br>
##&ensp;&ensp;&ensp;&ensp;&ensp;"prosite",&ensp;"interpro"),&ensp;filters="entrezgene",&ensp;<br>
##&ensp;&ensp;&ensp;&ensp;&ensp;value=EGsub,&ensp;mart=ensembl)&ensp;<br>
##&ensp;interpro&ensp;=&ensp;split(domains$interpro,&ensp;domains$entrezgene)<br>
##&ensp;interpro[1]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont43'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk43' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(43)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk43'>
        <span class='header'>
          ## Chunk 43
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(43)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk43' onclick='highlightChunk(43)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("hgu133a.db")<br>
dbc&ensp;=&ensp;hgu133a_dbconn()
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont44'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk44' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(44)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk44'>
        <span class='header'>
          ## Chunk 44
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(44)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk44' onclick='highlightChunk(44)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

get("201473_at",&ensp;hgu133aSYMBOL)<br>
mget(c("201473_at","201476_s_at"),&ensp;hgu133aSYMBOL)<br>
hgu133aSYMBOL$"201473_at"<br>
hgu133aSYMBOL[["201473_at"]]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont45'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk45' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(45)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk45'>
        <span class='header'>
          ## Chunk 45
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(45)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk45' onclick='highlightChunk(45)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

goCats&ensp;=&ensp;unlist(eapply(GOTERM,&ensp;Ontology))<br>
gCnums&ensp;=&ensp;table(goCats)[c("BP","CC",&ensp;"MF")]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont46'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk46' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(46)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk46'>
        <span class='header'>
          ## Chunk 46
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(46)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk46' onclick='highlightChunk(46)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

##&ensp;library("xtable")<br>
##&ensp;xtable(as.matrix(gCnums),&ensp;display=c("d",&ensp;"d"),<br>
##&ensp;&ensp;&ensp;&ensp;&ensp;caption="Number&ensp;of&ensp;GO&ensp;terms&ensp;per&ensp;ontology.",&ensp;<br>
##&ensp;&ensp;&ensp;&ensp;&ensp;label="ta:GOprops")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont47'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk47' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(47)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk47'>
        <span class='header'>
          ## Chunk 47
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(47)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk47' onclick='highlightChunk(47)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("xtable")<br>
cat(print(xtable(as.matrix(gCnums),&ensp;display=c("d",&ensp;"d"),<br>
&ensp;&ensp;&ensp;&ensp;caption="Number&ensp;of&ensp;\\indexTerm[Gene&ensp;Ontology&ensp;(GO)]{GO}&ensp;terms&ensp;per&ensp;ontology.",&ensp;<br>
&ensp;&ensp;&ensp;&ensp;label="ta:GOprops"),&ensp;file="table1.tex"))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont48'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk48' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(48)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk48'>
        <span class='header'>
          ## Chunk 48
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(48)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk48' onclick='highlightChunk(48)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

query&ensp;=&ensp;"select&ensp;ontology&ensp;from&ensp;go_term"<br>
goCats&ensp;=&ensp;dbGetQuery(GO_dbconn(),&ensp;query)<br>
gCnums2&ensp;=&ensp;table(goCats)[c("BP","CC",&ensp;"MF")]<br>
identical(gCnums,&ensp;gCnums2)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont49'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk49' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(49)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk49'>
        <span class='header'>
          ## Chunk 49
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(49)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk49' onclick='highlightChunk(49)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

query&ensp;=&ensp;paste("select&ensp;term&ensp;from&ensp;go_term&ensp;where&ensp;term",<br>
&ensp;&ensp;&ensp;&ensp;"like&ensp;'%chromosome%'")<br>
chrTerms&ensp;=&ensp;dbGetQuery(GO_dbconn(),&ensp;query)<br>
nrow(chrTerms)<br>
head(chrTerms)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont50'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk50' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(50)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk50'>
        <span class='header'>
          ## Chunk 50
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(50)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk50' onclick='highlightChunk(50)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

query&ensp;=&ensp;paste("select&ensp;go_id&ensp;from&ensp;go_term&ensp;where",<br>
&ensp;&ensp;&ensp;&ensp;"term&ensp;=&ensp;'transcription&ensp;factor&ensp;binding'")<br>
tfb&ensp;=&ensp;dbGetQuery(GO_dbconn(),&ensp;query)<br>
tfbps&ensp;=&ensp;&ensp;hgu133aGO2ALLPROBES[[tfb$go_id]]<br>
table(names(tfbps))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont51'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk51'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(51)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk51'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk51' style='display:none;'>
        <span class='header'>
          ## Chunk 51
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(51)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk51' onclick='highlightChunk(51)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

query&ensp;=&ensp;paste("select&ensp;term&ensp;from&ensp;go_term&ensp;where&ensp;term",<br>
&ensp;&ensp;&ensp;&ensp;"like&ensp;'%transcription&ensp;factor%'")<br>
tf&ensp;=&ensp;dbGetQuery(GO_dbconn(),&ensp;query)<br>
nrow(tf)<br>
head(tf)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont52'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk52' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(52)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk52'>
        <span class='header'>
          ## Chunk 52
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(52)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk52' onclick='highlightChunk(52)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

queryAlias&ensp;=&ensp;function(x)&ensp;{<br>
&ensp;&ensp;it&ensp;=&ensp;paste("('",&ensp;paste(x,&ensp;collapse="',&ensp;'"),&ensp;"'",&ensp;sep="")<br>
&ensp;&ensp;paste("select&ensp;_id,&ensp;alias_symbol&ensp;from&ensp;alias",<br>
&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;"where&ensp;alias_symbol&ensp;in",&ensp;it,&ensp;");")<br>
}<br>
queryGeneinfo&ensp;=&ensp;function(x)&ensp;{<br>
&ensp;&ensp;it&ensp;=&ensp;paste("('",&ensp;paste(x,&ensp;collapse="',&ensp;'"),&ensp;"'",&ensp;sep="")<br>
&ensp;&ensp;paste("select&ensp;_id,&ensp;symbol&ensp;from&ensp;gene_info&ensp;where",<br>
&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;"symbol&ensp;in",&ensp;it,&ensp;");")<br>
}<br>
queryGenes&ensp;=&ensp;function(x)&ensp;{<br>
&ensp;&ensp;it&ensp;=&ensp;paste("('",&ensp;paste(x,&ensp;collapse="',&ensp;'"),&ensp;"'",&ensp;sep="")<br>
&ensp;&ensp;paste("select&ensp;*&ensp;from&ensp;genes&ensp;where&ensp;_id&ensp;in",&ensp;it,&ensp;&ensp;");")<br>
}<br>
findEGs&ensp;=&ensp;function(dbcon,&ensp;symbols)&ensp;{<br>
&ensp;&ensp;rs&ensp;=&ensp;dbSendQuery(dbcon,&ensp;queryGeneinfo(symbols))<br>
&ensp;&ensp;a1&ensp;=&ensp;fetch(rs,&ensp;n=-1)<br>
&ensp;&ensp;stillLeft&ensp;=&ensp;setdiff(symbols,&ensp;a1[,2])<br>
&ensp;&ensp;if(&ensp;length(stillLeft)>0&ensp;)&ensp;{<br>
&ensp;&ensp;&ensp;&ensp;rs&ensp;=&ensp;dbSendQuery(dbcon,&ensp;queryAlias(stillLeft))<br>
&ensp;&ensp;&ensp;&ensp;a2&ensp;=&ensp;fetch(rs,&ensp;n=-1)<br>
&ensp;&ensp;&ensp;&ensp;names(a2)&ensp;=&ensp;names(a1)<br>
&ensp;&ensp;&ensp;&ensp;a1&ensp;=&ensp;rbind(a1,&ensp;a2)<br>
&ensp;&ensp;}&ensp;<br>
&ensp;&ensp;<br>
&ensp;&ensp;rs&ensp;=&ensp;dbSendQuery(dbcon,&ensp;queryGenes(a1[,1]))<br>
&ensp;&ensp;merge(a1,&ensp;fetch(rs,&ensp;n=-1))<br>
}
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont53'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk53' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(53)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk53'>
        <span class='header'>
          ## Chunk 53
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(53)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk53' onclick='highlightChunk(53)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

findEGs(dbc,&ensp;c("ALL1",&ensp;"AF4",&ensp;"BCR",&ensp;"ABL"))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont54'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk54' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(54)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk54'>
        <span class='header'>
          ## Chunk 54
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(54)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk54' onclick='highlightChunk(54)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

s1&ensp;=&ensp;revmap(hgu133aSYMBOL)<br>
s1$BCR
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont55'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk55' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(55)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk55'>
        <span class='header'>
          ## Chunk 55
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(55)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk55' onclick='highlightChunk(55)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

toTable(hgu133aGO["201473_at"])
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
  </table>
</div>
</body></html>
