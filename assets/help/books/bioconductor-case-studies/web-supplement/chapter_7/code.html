<html>
  <head>
    <title>
      Code examples for Chapter 7: 'Differential Expression'
    </title>

    <link rel='stylesheet' type='text/css' href='../useRbook.css'>
    <script src='../useRbook.js' type='text/javascript'></script>
  </head>
  <body style='font-family: helvetica,arial,sans-serif;'>
<small>
  <a class='down' href='DE.R' target='_blank'>
    download code
  </a>
</small>

<div align='center'>  <table width='400' class='codeContainer'>

<table class='codeContainer' id='chunkCont1'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk1' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(1)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk1'>
        <span class='header'>
          ## Chunk 1
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(1)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk1' onclick='highlightChunk(1)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("ALL")<br>
data("ALL")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont2'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk2' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(2)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk2'>
        <span class='header'>
          ## Chunk 2
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(2)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk2' onclick='highlightChunk(2)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

bcell&ensp;=&ensp;grep("^B",&ensp;as.character(ALL$BT))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont3'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk3' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(3)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk3'>
        <span class='header'>
          ## Chunk 3
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(3)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk3' onclick='highlightChunk(3)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

moltyp&ensp;=&ensp;which(as.character(ALL$mol.biol)&ensp;<br>
&ensp;&ensp;&ensp;&ensp;%in%&ensp;c("NEG",&ensp;"BCR/ABL"))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont4'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk4' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(4)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk4'>
        <span class='header'>
          ## Chunk 4
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(4)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk4' onclick='highlightChunk(4)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

ALL_bcrneg&ensp;=&ensp;ALL[,&ensp;intersect(bcell,&ensp;moltyp)]<br>
ALL_bcrneg$mol.biol&ensp;=&ensp;factor(ALL_bcrneg$mol.biol)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont5'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk5' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(5)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk5'>
        <span class='header'>
          ## Chunk 5
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(5)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk5' onclick='highlightChunk(5)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("vsn")<br>
meanSdPlot(ALL_bcrneg)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont6'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk6' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(6)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk6'>
        <span class='header'>
          ## Chunk 6
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(6)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk6' onclick='highlightChunk(6)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

sds&ensp;=&ensp;esApply(ALL,&ensp;1,&ensp;sd)<br>
sel&ensp;=&ensp;(sds&ensp;>&ensp;quantile(sds,&ensp;0.8))<br>
ALLset1&ensp;=&ensp;ALL_bcrneg[sel,]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont7'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk7' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(7)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk7'>
        <span class='header'>
          ## Chunk 7
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(7)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk7' onclick='highlightChunk(7)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("genefilter")<br>
tt&ensp;=&ensp;rowttests(ALLset1,&ensp;"mol.biol")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont8'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk8' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(8)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk8'>
        <span class='header'>
          ## Chunk 8
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(8)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk8' onclick='highlightChunk(8)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

names(tt)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont9'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk9' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(9)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk9'>
        <span class='header'>
          ## Chunk 9
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(9)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk9' onclick='highlightChunk(9)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

plot(tt$dm,&ensp;-log10(tt$p.value),&ensp;pch=".",&ensp;<br>
&ensp;&ensp;&ensp;&ensp;xlab&ensp;=&ensp;expression(mean~log[2]~fold~change),<br>
&ensp;&ensp;&ensp;&ensp;ylab&ensp;=&ensp;expression(-log[10](p)))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont10'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk10'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(10)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk10'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk10' style='display:none;'>
        <span class='header'>
          ## Chunk 10
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(10)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk10' onclick='highlightChunk(10)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

sum(tt$p.value<0.05&ensp;&&ensp;abs(tt$dm)>0.5)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont11'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk11' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(11)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk11'>
        <span class='header'>
          ## Chunk 11
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(11)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk11' onclick='highlightChunk(11)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("multtest")<br>
cl&ensp;=&ensp;as.numeric(ALLset1$mol.biol=="BCR/ABL")&ensp;<br>
resT&ensp;=&ensp;mt.maxT(exprs(ALLset1),&ensp;classlabel=cl,&ensp;B=1000)<br>
ord&ensp;=&ensp;order(resT$index)&ensp;&ensp;##&ensp;the&ensp;original&ensp;gene&ensp;order<br>
rawp&ensp;=&ensp;resT$rawp[ord]&ensp;&ensp;&ensp;&ensp;##&ensp;permutation&ensp;p-values&ensp;
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont12'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk12' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(12)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk12'>
        <span class='header'>
          ## Chunk 12
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(12)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk12' onclick='highlightChunk(12)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

hist(rawp,&ensp;breaks=50,&ensp;col="#B2DF8A")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont13'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk13' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(13)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk13'>
        <span class='header'>
          ## Chunk 13
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(13)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk13' onclick='highlightChunk(13)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

sum(resT$adjp<0.05)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont14'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk14' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(14)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk14'>
        <span class='header'>
          ## Chunk 14
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(14)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk14' onclick='highlightChunk(14)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

res&ensp;=&ensp;mt.rawp2adjp(rawp,&ensp;proc&ensp;=&ensp;"BH")<br>
sum(res$adjp[,"BH"]<0.05)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont15'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk15' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(15)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk15'>
        <span class='header'>
          ## Chunk 15
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(15)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk15' onclick='highlightChunk(15)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("limma")<br>
design&ensp;&ensp;=&ensp;cbind(mean&ensp;=&ensp;1,&ensp;diff&ensp;=&ensp;cl)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont16'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk16' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(16)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk16'>
        <span class='header'>
          ## Chunk 16
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(16)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk16' onclick='highlightChunk(16)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

fit&ensp;=&ensp;lmFit(exprs(ALLset1),&ensp;design)<br>
fit&ensp;=&ensp;eBayes(fit)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont17'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk17' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(17)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk17'>
        <span class='header'>
          ## Chunk 17
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(17)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk17' onclick='highlightChunk(17)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("hgu95av2.db")<br>
ALLset1Syms&ensp;=&ensp;unlist(mget(featureNames(ALLset1),&ensp;<br>
&ensp;&ensp;&ensp;&ensp;env&ensp;=&ensp;hgu95av2SYMBOL))&ensp;<br>
topTable(fit,&ensp;coef&ensp;=&ensp;"diff",&ensp;adjust.method&ensp;=&ensp;"fdr",&ensp;<br>
&ensp;&ensp;&ensp;&ensp;sort.by&ensp;=&ensp;"p",&ensp;genelist&ensp;=&ensp;ALLset1Syms)&ensp;
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont18'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk18' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(18)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk18'>
        <span class='header'>
          ## Chunk 18
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(18)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk18' onclick='highlightChunk(18)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

plot(-log10(tt$p.value),&ensp;-log10(fit$p.value[,&ensp;"diff"]),<br>
&ensp;&ensp;&ensp;&ensp;xlab&ensp;=&ensp;"-log10(p)&ensp;from&ensp;two-sample&ensp;t-test",&ensp;&ensp;<br>
&ensp;&ensp;&ensp;&ensp;ylab&ensp;=&ensp;"-log10(p)&ensp;from&ensp;moderated&ensp;t-test&ensp;(limma)",&ensp;<br>
&ensp;&ensp;&ensp;&ensp;pch=".")<br>
abline(c(0,&ensp;1),&ensp;col&ensp;=&ensp;"red")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont19'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk19' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(19)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk19'>
        <span class='header'>
          ## Chunk 19
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(19)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk19' onclick='highlightChunk(19)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

subs&ensp;=&ensp;c(35,&ensp;65,&ensp;75,&ensp;1,&ensp;69,&ensp;71)<br>
ALLset2&ensp;=&ensp;&ensp;ALL_bcrneg[,&ensp;subs]<br>
table(ALLset2$mol.biol)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont20'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk20' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(20)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk20'>
        <span class='header'>
          ## Chunk 20
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(20)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk20' onclick='highlightChunk(20)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

tt2&ensp;&ensp;=&ensp;rowttests(ALLset2,&ensp;"mol.biol")<br>
fit2&ensp;=&ensp;eBayes(lmFit(exprs(ALLset2),&ensp;design=design[subs,&ensp;]))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont21'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk21' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(21)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk21'>
        <span class='header'>
          ## Chunk 21
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(21)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk21' onclick='highlightChunk(21)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

plot(-log10(tt2$p.value),&ensp;-log10(fit2$p.value[,&ensp;"diff"]),<br>
&ensp;&ensp;&ensp;&ensp;xlab&ensp;=&ensp;"-log10(p)&ensp;from&ensp;two-sample&ensp;t-test",&ensp;&ensp;<br>
&ensp;&ensp;&ensp;&ensp;ylab&ensp;=&ensp;"-log10(p)&ensp;from&ensp;moderated&ensp;t-test&ensp;(limma)",&ensp;<br>
&ensp;&ensp;&ensp;&ensp;pch=".")<br>
abline(c(0,&ensp;1),&ensp;col&ensp;=&ensp;"red")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont22'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk22' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(22)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk22'>
        <span class='header'>
          ## Chunk 22
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(22)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk22' onclick='highlightChunk(22)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

g&ensp;=&ensp;which(tt2$p.value&ensp;<&ensp;1e-4&ensp;&&ensp;&ensp;<br>
&ensp;&ensp;&ensp;&ensp;fit2$p.value[,&ensp;"diff"]&ensp;>&ensp;0.02)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont23'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk23' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(23)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk23'>
        <span class='header'>
          ## Chunk 23
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(23)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk23' onclick='highlightChunk(23)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

sel&ensp;=&ensp;(ALLset2$mol.bio&ensp;==&ensp;"BCR/ABL")+1<br>
col&ensp;=&ensp;c("black",&ensp;"red")[sel]<br>
pch&ensp;=&ensp;c(1,16)[sel]<br>
plot(exprs(ALLset2)[g,],&ensp;pch=pch,&ensp;col=col,<br>
&ensp;&ensp;&ensp;&ensp;ylab="expression")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont24'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk24' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(24)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk24'>
        <span class='header'>
          ## Chunk 24
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(24)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk24' onclick='highlightChunk(24)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

rocs&ensp;=&ensp;rowpAUCs(ALLset1,&ensp;"mol.biol",&ensp;p=0.2)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont25'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk25' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(25)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk25'>
        <span class='header'>
          ## Chunk 25
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(25)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk25' onclick='highlightChunk(25)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

j&ensp;=&ensp;which.max(area(rocs))<br>
plot(rocs[j],&ensp;main&ensp;=&ensp;featureNames(ALLset1)[j])
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont26'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk26'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(26)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk26'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk26' style='display:none;'>
        <span class='header'>
          ## Chunk 26
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(26)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk26' onclick='highlightChunk(26)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

mtyp&ensp;=&ensp;ALLset1$mol.biol<br>
sel&ensp;=&ensp;rep(1:2,&ensp;each=rev(table(mtyp)))<br>
plot(exprs(ALLset1)[j,&ensp;order(mtyp)],&ensp;pch=c(1,15)[sel],&ensp;<br>
&ensp;&ensp;&ensp;&ensp;col=c("black",&ensp;"red")[sel],&ensp;<br>
&ensp;&ensp;&ensp;&ensp;main=featureNames(ALLset1)[j],&ensp;<br>
&ensp;&ensp;&ensp;&ensp;ylab=expression(log[2]~expression~level))<br>
legend("bottomleft",&ensp;col=c("black",&ensp;"red"),&ensp;<br>
&ensp;&ensp;&ensp;&ensp;pch=c(1,15),&ensp;levels(mtyp),&ensp;bty="n")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont27'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk27' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(27)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk27'>
        <span class='header'>
          ## Chunk 27
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(27)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk27' onclick='highlightChunk(27)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

nrsel.ttest&ensp;=&ensp;function(x,&ensp;pthresh=0.05)&ensp;{<br>
&ensp;&ensp;&ensp;&ensp;pval&ensp;=&ensp;rowttests(x,&ensp;"mol.biol")$p.value<br>
&ensp;&ensp;&ensp;&ensp;return(sum(pval&ensp;<&ensp;pthresh))<br>
}
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont28'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk28' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(28)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk28'>
        <span class='header'>
          ## Chunk 28
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(28)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk28' onclick='highlightChunk(28)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

nrsel.pAUC&ensp;=&ensp;function(x,&ensp;pAUCthresh=2.5e-2)&ensp;{<br>
&ensp;&ensp;&ensp;&ensp;&ensp;pAUC&ensp;=&ensp;area(rowpAUCs(x,&ensp;fac="mol.biol",&ensp;p=0.1))<br>
&ensp;&ensp;&ensp;&ensp;&ensp;return(sum(pAUC&ensp;>&ensp;pAUCthresh))<br>
}
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont29'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk29' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(29)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk29'>
        <span class='header'>
          ## Chunk 29
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(29)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk29' onclick='highlightChunk(29)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library(BiocCaseStudies)<br>
x&ensp;=&ensp;ALLset1[sample(nrow(ALLset1),&ensp;1000),&ensp;]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont30'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk30' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(30)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk30'>
        <span class='header'>
          ## Chunk 30
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(30)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk30' onclick='highlightChunk(30)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

par(mfrow&ensp;=&ensp;c(1,&ensp;2))<br>
resample(x,&ensp;"nrsel.ttest")<br>
resample(x,&ensp;"nrsel.pAUC")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont31'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk31' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(31)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk31'>
        <span class='header'>
          ## Chunk 31
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(31)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk31' onclick='highlightChunk(31)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

##&ensp;resample(x,&ensp;"nrsel.ttest")<br>
##&ensp;resample(x,&ensp;"nrsel.pAUC")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
  </table>
</div>
</body></html>
