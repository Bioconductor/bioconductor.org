<html>
  <head>
    <title>
      Code examples for Chapter 13: 'Gene Set Enrichment Analysis'
    </title>

    <link rel='stylesheet' type='text/css' href='../useRbook.css'>
    <script src='../useRbook.js' type='text/javascript'></script>
  </head>
  <body style='font-family: helvetica,arial,sans-serif;'>
<small>
  <a class='down' href='Category.R' target='_blank'>
    download code
  </a>
</small>

<div align='center'>  <table width='400' class='codeContainer'>

<table class='codeContainer' id='chunkCont1'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk1' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(1)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk1'>
        <span class='header'>
          ## Chunk 1
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(1)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk1' onclick='highlightChunk(1)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("ALL")<br>
data("ALL")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont2'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk2' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(2)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk2'>
        <span class='header'>
          ## Chunk 2
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(2)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk2' onclick='highlightChunk(2)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

bcell&ensp;=&ensp;grep("^B",&ensp;as.character(ALL$BT))<br>
moltyp&ensp;=&ensp;which(as.character(ALL$mol.biol)&ensp;<br>
&ensp;&ensp;&ensp;&ensp;%in%&ensp;c("NEG",&ensp;"BCR/ABL"))<br>
ALL_bcrneg&ensp;=&ensp;ALL[,&ensp;intersect(bcell,&ensp;moltyp)]<br>
ALL_bcrneg$mol.biol&ensp;=&ensp;factor(ALL_bcrneg$mol.biol)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont3'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk3' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(3)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk3'>
        <span class='header'>
          ## Chunk 3
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(3)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk3' onclick='highlightChunk(3)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("genefilter")<br>
ALLfilt_bcrneg&ensp;=&ensp;nsFilter(ALL_bcrneg,&ensp;var.cutoff=0.5)$eset
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont4'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk4'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(4)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk4'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk4' style='display:none;'>
        <span class='header'>
          ## Chunk 4
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(4)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk4' onclick='highlightChunk(4)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

table(ALLfilt_bcrneg$mol.biol)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont5'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk5' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(5)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk5'>
        <span class='header'>
          ## Chunk 5
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(5)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk5' onclick='highlightChunk(5)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("GSEABase")<br>
gsc&ensp;=&ensp;GeneSetCollection(ALLfilt_bcrneg,&ensp;<br>
&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;setType=KEGGCollection())<br>
Am&ensp;=&ensp;incidence(gsc)<br>
dim(Am)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont6'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk6' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(6)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk6'>
        <span class='header'>
          ## Chunk 6
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(6)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk6' onclick='highlightChunk(6)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

nsF&ensp;=&ensp;ALLfilt_bcrneg[colnames(Am),]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont7'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk7' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(7)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk7'>
        <span class='header'>
          ## Chunk 7
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(7)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk7' onclick='highlightChunk(7)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

rtt&ensp;=&ensp;rowttests(nsF,&ensp;"mol.biol")<br>
rttStat&ensp;=&ensp;rtt$statistic
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont8'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk8' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(8)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk8'>
        <span class='header'>
          ## Chunk 8
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(8)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk8' onclick='highlightChunk(8)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

selectedRows&ensp;=&ensp;(rowSums(Am)>10)<br>
Am2&ensp;=&ensp;Am[selectedRows,&ensp;]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont9'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk9' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(9)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk9'>
        <span class='header'>
          ## Chunk 9
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(9)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk9' onclick='highlightChunk(9)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

tA&ensp;=&ensp;as.vector(Am2&ensp;%*%&ensp;rttStat)<br>
tAadj&ensp;=&ensp;tA/sqrt(rowSums(Am2))<br>
names(tA)&ensp;=&ensp;names(tAadj)&ensp;=&ensp;rownames(Am2)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont10'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk10' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(10)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk10'>
        <span class='header'>
          ## Chunk 10
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(10)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk10' onclick='highlightChunk(10)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

stopifnot(sum(tAadj<(-8))==1L)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont11'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk11' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(11)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk11'>
        <span class='header'>
          ## Chunk 11
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(11)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk11' onclick='highlightChunk(11)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

qqnorm(tAadj)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont12'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk12' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(12)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk12'>
        <span class='header'>
          ## Chunk 12
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(12)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk12' onclick='highlightChunk(12)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("KEGG.db")<br>
smPW&ensp;=&ensp;tAadj[tAadj&ensp;<&ensp;(-8)]<br>
pwName&ensp;=&ensp;KEGGPATHID2NAME[[names(smPW)]]<br>
pwName
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont13'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk13' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(13)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk13'>
        <span class='header'>
          ## Chunk 13
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(13)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk13' onclick='highlightChunk(13)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

KEGGmnplot(names(smPW),&ensp;nsF,&ensp;"hgu95av2",&ensp;nsF$"mol.biol",<br>
&ensp;&ensp;pch=16,&ensp;col="darkblue")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont14'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk14' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(14)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk14'>
        <span class='header'>
          ## Chunk 14
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(14)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk14' onclick='highlightChunk(14)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

sel&ensp;=&ensp;as.integer(nsF$mol.biol)<br>
KEGG2heatmap(names(smPW),&ensp;nsF,&ensp;"hgu95av2",&ensp;<br>
&ensp;&ensp;col=colorRampPalette(c("white",&ensp;"darkblue"))(256),<br>
&ensp;&ensp;ColSideColors=c("black",&ensp;"white")[sel])
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont15'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk15' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(15)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk15'>
        <span class='header'>
          ## Chunk 15
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(15)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk15' onclick='highlightChunk(15)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

stopifnot(nlevels(nsF$mol.biol)==2L)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont16'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk16' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(16)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk16'>
        <span class='header'>
          ## Chunk 16
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(16)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk16' onclick='highlightChunk(16)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library(Category)<br>
set.seed(123)<br>
NPERM&ensp;=&ensp;1000<br>
pvals&ensp;=&ensp;gseattperm(nsF,&ensp;nsF$mol.biol,&ensp;Am2,&ensp;NPERM)<br>
pvalCut&ensp;=&ensp;0.025<br>
lowC&ensp;&ensp;=&ensp;names(which(pvals[,&ensp;1]<=pvalCut))<br>
highC&ensp;=&ensp;names(which(pvals[,&ensp;2]<=pvalCut))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont17'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk17' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(17)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk17'>
        <span class='header'>
          ## Chunk 17
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(17)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk17' onclick='highlightChunk(17)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

##&ensp;stopifnot(identical(1L,length(lowC)))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont18'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk18' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(18)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk18'>
        <span class='header'>
          ## Chunk 18
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(18)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk18' onclick='highlightChunk(18)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

fmt&ensp;=&ensp;function(x)&ensp;as.vector(mapply(paste,&ensp;names(x),&ensp;x,&ensp;sep=":&ensp;"))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont19'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk19' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(19)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk19'>
        <span class='header'>
          ## Chunk 19
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(19)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk19' onclick='highlightChunk(19)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

##&ensp;getPathNames(lowC)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont20'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk20' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(20)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk20'>
        <span class='header'>
          ## Chunk 20
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(20)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk20' onclick='highlightChunk(20)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

fmt(getPathNames(lowC))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont21'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk21' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(21)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk21'>
        <span class='header'>
          ## Chunk 21
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(21)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk21' onclick='highlightChunk(21)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

##&ensp;getPathNames(highC)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont22'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk22' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(22)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk22'>
        <span class='header'>
          ## Chunk 22
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(22)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk22' onclick='highlightChunk(22)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

fmt(getPathNames(highC))[1:5]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont23'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk23'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(23)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk23'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk23' style='display:none;'>
        <span class='header'>
          ## Chunk 23
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(23)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk23' onclick='highlightChunk(23)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

apply(pvals,&ensp;2,&ensp;min)<br>
rownames(pvals)[apply(pvals,&ensp;2,&ensp;which.min)]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont24'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk24'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(24)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk24'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk24' style='display:none;'>
        <span class='header'>
          ## Chunk 24
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(24)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk24' onclick='highlightChunk(24)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

permpvs&ensp;&ensp;=&ensp;pmin(pvals[,1],&ensp;pvals[,2])<br>
pvsparam&ensp;=&ensp;pnorm(tAadj)<br>
pvspara&ensp;&ensp;=&ensp;pmin(pvsparam,&ensp;1-pvsparam)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont25'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk25'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(25)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk25'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk25' style='display:none;'>
        <span class='header'>
          ## Chunk 25
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(25)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk25' onclick='highlightChunk(25)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

plot(permpvs,&ensp;pvspara,&ensp;xlab="Permutation&ensp;p-values",<br>
&ensp;&ensp;&ensp;&ensp;&ensp;ylab="Parametric&ensp;p-values")
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont26'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk26'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(26)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk26'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk26' style='display:none;'>
        <span class='header'>
          ## Chunk 26
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(26)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk26' onclick='highlightChunk(26)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

##&ensp;depending&ensp;on&ensp;which&ensp;annotation&ensp;infrastructure&ensp;we&ensp;use<br>
##&ensp;hgu95av2MAP&ensp;will&ensp;either&ensp;be&ensp;an&ensp;environment&ensp;or&ensp;an<br>
##&ensp;AnnDbBimap&ensp;object<br>
fnames&ensp;=&ensp;featureNames(ALLfilt_bcrneg)<br>
if(is(hgu95av2MAP,&ensp;"environment")){<br>
&ensp;&ensp;&ensp;&ensp;chrLocs&ensp;=&ensp;mget(fnames,&ensp;hgu95av2MAP)<br>
&ensp;&ensp;&ensp;&ensp;mapping&ensp;=&ensp;names(chrLocs[sapply(chrLocs,&ensp;<br>
&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;function(x)&ensp;!all(is.na(x)))])<br>
}else{<br>
&ensp;&ensp;&ensp;&ensp;mapping&ensp;=&ensp;toTable(hgu95av2MAP[fnames])$probe_id<br>
}<br>
psWithMAP&ensp;=&ensp;unique(mapping)<br>
nsF2&ensp;=&ensp;ALLfilt_bcrneg[psWithMAP,&ensp;]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont27'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk27' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(27)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk27'>
        <span class='header'>
          ## Chunk 27
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(27)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk27' onclick='highlightChunk(27)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

EGtable&ensp;=&ensp;toTable(hgu95av2ENTREZID[featureNames(nsF2)])<br>
entrezUniv&ensp;=&ensp;unique(EGtable$gene_id)<br>
chrMat&ensp;=&ensp;MAPAmat("hgu95av2",&ensp;univ=entrezUniv)<br>
rSchr&ensp;=&ensp;rowSums(chrMat)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont28'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk28'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(28)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk28'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk28' style='display:none;'>
        <span class='header'>
          ## Chunk 28
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(28)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk28' onclick='highlightChunk(28)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

dim(chrMat)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont29'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk29'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(29)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk29'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk29' style='display:none;'>
        <span class='header'>
          ## Chunk 29
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(29)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk29' onclick='highlightChunk(29)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

chrMat&ensp;=&ensp;chrMat[rowSums(chrMat)&ensp;>=&ensp;5,&ensp;]<br>
dim(chrMat)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont30'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk30'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(30)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk30'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk30' style='display:none;'>
        <span class='header'>
          ## Chunk 30
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(30)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk30' onclick='highlightChunk(30)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

EGlist&ensp;=&ensp;mget(featureNames(nsF2),&ensp;&ensp;hgu95av2ENTREZID)<br>
EGIDs&ensp;=&ensp;sapply(EGlist,&ensp;"[",&ensp;1)<br>
idx&ensp;=&ensp;match(EGIDs,&ensp;colnames(chrMat))<br>
chrMat&ensp;=&ensp;chrMat[,&ensp;idx]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont31'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk31' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(31)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk31'>
        <span class='header'>
          ## Chunk 31
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(31)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk31' onclick='highlightChunk(31)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

Ams&ensp;=&ensp;Am2[union(lowC,&ensp;highC),]<br>
Amx&ensp;=&ensp;Ams&ensp;%*%&ensp;t(Ams)<br>
minS&ensp;=&ensp;outer(diag(Amx),&ensp;diag(Amx),&ensp;pmin)<br>
overlapIndex&ensp;=&ensp;Amx/minS
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont32'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk32' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(32)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk32'>
        <span class='header'>
          ## Chunk 32
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(32)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk32' onclick='highlightChunk(32)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

library("lattice")<br>
myFun&ensp;=&ensp;function(x)&ensp;{<br>
&ensp;&ensp;dd.row&ensp;=&ensp;as.dendrogram(hclust(dist(x)))<br>
&ensp;&ensp;row.ord&ensp;=&ensp;order.dendrogram(dd.row)<br>
&ensp;&ensp;<br>
&ensp;&ensp;dd.col&ensp;=&ensp;as.dendrogram(hclust(dist(t(x))))<br>
&ensp;&ensp;col.ord&ensp;=&ensp;order.dendrogram(dd.col)<br>
&ensp;&ensp;colnames(x)&ensp;=&ensp;sapply(getPathNames(colnames(x)),&ensp;"[",&ensp;1L)<br>
&ensp;&ensp;levelplot(x[row.ord,col.ord],&ensp;&ensp;scales&ensp;=&ensp;list(x&ensp;=&ensp;list(rot&ensp;=&ensp;90)),<br>
&ensp;&ensp;&ensp;&ensp;xlab="",&ensp;ylab="",&ensp;main="overlapIndex",<br>
&ensp;&ensp;&ensp;&ensp;col.regions=colorRampPalette(c("white",&ensp;"darkblue"))(256))<br>
}<br>
print(myFun(overlapIndex))
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont33'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk33' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(33)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk33'>
        <span class='header'>
          ## Chunk 33
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(33)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk33' onclick='highlightChunk(33)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

ijord&ensp;=&ensp;function(m,&ensp;i)&ensp;{<br>
&ensp;&ensp;m[lower.tri(m,&ensp;diag=TRUE)]&ensp;=&ensp;NA<br>
&ensp;&ensp;o=order(m,&ensp;decreasing=TRUE,&ensp;na.last=TRUE)[i]<br>
&ensp;&ensp;cbind((o-1L)%/%nrow(m)+1L,&ensp;(o-1L)%%nrow(m)+1L)<br>
}&ensp;&ensp;<br>
nm&ensp;=&ensp;getPathNames(colnames(overlapIndex))<br>
pathnames&ensp;=&ensp;as.vector(mapply(paste,&ensp;names(nm),&ensp;sapply(nm,&ensp;"[",&ensp;1L),&ensp;sep=":&ensp;"))<br>
k=ijord(overlapIndex,&ensp;1:2)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont34'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk34'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(34)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk34'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk34' style='display:none;'>
        <span class='header'>
          ## Chunk 34
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(34)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk34' onclick='highlightChunk(34)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

rowSums(Ams)[c("04510",&ensp;"04512",&ensp;"04514",&ensp;"04940")]<br>
Amx["04512",&ensp;"04510"]<br>
Amx["04940",&ensp;"04514"]
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont35'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk35' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(35)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk35'>
        <span class='header'>
          ## Chunk 35
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(35)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk35' onclick='highlightChunk(35)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

P04512&ensp;=&ensp;Ams["04512",]<br>
P04510&ensp;=&ensp;Ams["04510",]<br>
lm1&ensp;=&ensp;lm(rttStat&ensp;~&ensp;P04512)<br>
summary(lm1)$coefficients<br>
lm2&ensp;=&ensp;lm(rttStat&ensp;~&ensp;P04510)<br>
summary(lm2)$coefficients<br>
lm3&ensp;=&ensp;lm(rttStat&ensp;~&ensp;P04510+P04512)<br>
summary(lm3)$coefficients
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont36'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk36' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(36)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk36'>
        <span class='header'>
          ## Chunk 36
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(36)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk36' onclick='highlightChunk(36)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

stopifnot(<br>
coefficients(summary(lm1))["P04512",&ensp;"Pr(>|t|)"]<0.05,<br>
coefficients(summary(lm2))["P04510",&ensp;"Pr(>|t|)"]<0.05,<br>
coefficients(summary(lm3))["P04512",&ensp;"Pr(>|t|)"]>0.05,<br>
coefficients(summary(lm3))["P04510",&ensp;"Pr(>|t|)"]<0.05)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont37'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk37' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(37)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk37'>
        <span class='header'>
          ## Chunk 37
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(37)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk37' onclick='highlightChunk(37)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

P04512.Only&ensp;=&ensp;ifelse(P04512&ensp;!=&ensp;0&ensp;&&ensp;P04510&ensp;==&ensp;0,&ensp;1,&ensp;0)<br>
P04510.Only&ensp;=&ensp;ifelse(P04512&ensp;==&ensp;0&ensp;&&ensp;P04510&ensp;!=&ensp;0,&ensp;1,&ensp;0)<br>
Both&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;=&ensp;ifelse(P04512&ensp;!=&ensp;0&ensp;&&ensp;P04510&ensp;!=&ensp;0,&ensp;1,&ensp;0)<br>
lm4&ensp;=&ensp;lm(rttStat&ensp;~&ensp;P04510.Only&ensp;+&ensp;P04512.Only&ensp;+&ensp;Both)&ensp;
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='codeContainer' id='chunkCont38'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunk', id='showChunk38' style='display:none;'>
        <img src='../plusg.png' onclick='toggleChunk(38)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <div class='hideChunk', id='hideChunk38'>
        <span class='header'>
          ## Chunk 38
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(38)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk38' onclick='highlightChunk(38)'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

##&ensp;summary(lm4)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
<table class='hiddenCodeContainer' id='chunkCont39'>
  <tr class='chunkControl'>
    <td class='chunkControl'>
      <div class='showChunkSol' id='showChunk39'>
        <img class='showChunk' src='../plus.png' onclick='toggleChunk(39)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
      </div>
      <span class='solChunk' id='solChunk39'>
        &nbsp;&nbsp;(solution chunk)
      </span>
      <div class='hideChunk' id='hideChunk39' style='display:none;'>
        <span class='header'>
          ## Chunk 39
        </span>
        <span class='control'>
          <img class='cr' src='../minus.png' onclick='toggleChunk(39)' onMouseOver='hover(this)' onMouseOut='unhover(this)'>
        </span>
      </div>
    </td>
  </tr>
  <tr class='chunk' id='chunk39' onclick='highlightChunk(39)'style='display:none;'>
    <td class='chunk' colspan='4'>
      <code class='chunk'>

P04514&ensp;=&ensp;Ams["04514",]<br>
P04940&ensp;=&ensp;Ams["04940",]<br>
P04514.Only&ensp;=&ensp;ifelse(P04514&ensp;!=&ensp;0&ensp;&&ensp;P04940&ensp;==&ensp;0,&ensp;1,&ensp;0)<br>
P04940.Only&ensp;=&ensp;ifelse(P04514&ensp;==&ensp;0&ensp;&&ensp;P04940&ensp;!=&ensp;0,&ensp;1,&ensp;0)<br>
Both&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;=&ensp;ifelse(P04514&ensp;!=&ensp;0&ensp;&&ensp;P04940&ensp;!=&ensp;0,&ensp;1,&ensp;0)<br>
lm5&ensp;=&ensp;lm(rttStat&ensp;~&ensp;P04514.Only&ensp;+&ensp;P04940.Only&ensp;+&ensp;Both)&ensp;<br>
summary(lm5)
          </code>
        </td>
      </tr>
      <tr class='spacer'>
        <td class='spacer'>
</td>
</tr>
  </table>
</div>
</body></html>
